\section{Interfaz Gráfica: Arco Iris UI}
\label{sec:arcoIrisUI}

	\subsection{Introducción}

		\subsubsection{Motivaciones para una ``GUI''}

			Aún considerando las mejoras provistas por la extensión a Rainbow propuesta en el presente trabajo, uno de los
			escollos más notorios para poder utilizar de manera amena, ágil y productiva a Arco Iris es, sin dudas, la
			ausencia de una interfaz visual para que los \emph{stakeholders} y arquitectos de la aplicación puedan crear, editar
			y eliminar escenarios, entornos, \emph{artifacts} y otros conceptos introducidos en Arco Iris; así también como otros
			conceptos ya existentes en Rainbow.
			
			A fin de superar esta dificultad, se propone el desarrollo de una interfaz de usuario gráfica (GUI, de sus siglas en
			inglés: \emph{Graphical User Interface}) para que los distintos \emph{stakeholders}, incluyendo usuarios y
			arquitectos, puedan expresar los atributos de calidad (o ``ilities'') del sistema en formato de escenarios de QAW,
			que luego serán importados y utilizados por Arco Iris.
			
			En el presente apartado nos dedicaremos a repasar los aspectos más importantes de la aplicación, bautizada
			``Arco Iris UI''.

		\subsubsection{Herramienta de escritorio}

			Arco Iris UI es una aplicación de escritorio, hecha en Java y utilizando la librería \emph{JFace-SWT}\footnote{JFace fue
			desarrollado por IBM para facilitar la construcción del entorno de desarrollo Eclipse, pero su uso no está limitado a
			éste. JFace proporciona una serie de construcciones muy frecuentes a la hora de desarrollar interfaces gráficas de
			usuario, tales como cuadros de diálogo, evitando al programador la tediosa tarea de lidiar manualmente con los
			widgets de SWT. Fuente: \url{http://es.wikipedia.org/wiki/JFace}}, la cual provee un conjunto de \emph{widgets} para
			construír interfaces gráficas de usuario construido sobre SWT.
			
			Se prefirió una herramienta de escritorio por sobre una aplicación web principalmente porque las aplicaciones del
			primer tipo suelen proveer interfaces de usuario más ricas, intuitivas, ágiles y fáciles de usar que las
			aplicaciones web; todas estas, características deseables para que Arco Iris UI sea útil para los usuarios finales.
			
		\subsubsection{Idioma por defecto: inglés}

			Dado que Rainbow es una aplicación originalmente creada en Estados Unidos, y previendo que tanto Arco Iris como
			Arco Iris UI puedan ser aplicaciones tomadas por otros investigadores para ser extendidas, decidimos que lo más
			razonable es que estas aplicaciones estén codificadas en el idioma inglés. En el caso de Arco Iris UI, todos los
			textos mostrados en pantalla también están escritos en inglés, aunque todas las etiquetas se encuentran
			externalizadas a archivos de configuración, simplificando así la traducción a otros idiomas, en caso de que en un
			futuro fuera necesario.
			
		\subsubsection{Multi plataforma}

			Arco Iris UI es, como la gran mayoría de las aplicaciones Java, ejecutable desde los sistemas operativos
			más importantes, como por ejemplo Windows, Unix, MAC OS o Solaris. Debido a la utilización de las librerías SWT-JFace
			para la creación de la herramienta, las cuales poseen dependencias nativas del sistema operativo (i.e. el encargado
			de dibujar y refrescar los componentes visuales no es la máquina virtual de Java sino el sistema operativo) es
			necesario empaquetar la aplicación con diferentes dependencias java (i.e. archivos JAR) en el \emph{classpath} para
			poder correr la aplicación en distintas plataformas. En el apéndice \ref{sec:instalacionYEjecucionArcoIris} se
			explica en detalle los pasos necesarios para instalar y ejecutar las aplicaciones Arco Iris y Arco Iris UI.
		
	\subsection{Conceptos básicos de uso de la herramienta}

		\subsubsection{Formato de salida: XML}

			La configuración de \emph{Self Healing} que Arco Iris UI debe generar debe ser guardada en un archivo, en un
			determinado formato. Consideramos que el mejor formato para dicho archivo es el formato XML porque es un formato
			entendible no sólo por la computadora sino también por seres humanos. Esto es particularmente útil en el caso
			en que el usuario desee efectuar retoques mínimos sobre la configuración y no desee o no pueda por algún motivo
			correr Arco Iris UI. Dentro de este tipo de lenguajes (dónde se encuentran otros como JSON o YAML\footnote{Para más
			información sobre estos lenguajes de intercambio de datos, visitar \url{http://www.json.org/} o
			\url{http://www.yaml.org/}}) elegimos el formato XML por ser el más ampliamente conocido.
			
			La mecánica de serialización de una configuración de \emph{Self Healing} creada en Java utilizando Arco Iris UI a
			XML y la importación de dicho XML en Arco Iris es llevada a cabo utilizando el reconocido parser ``XStream''
			\footnote{Para más información, visitar \url{http://xstream.codehaus.org/}}, el cual permite fácilmente convertir
			objetos Java en XML y viceversa.
			
			En el apéndice \ref{sec:SelfHealingConfigXML}, podemos observar un ejemplo de un archivo de configuración de
			\emph{Self Healing} generado por Arco Iris UI.
	
		\subsubsection{Una configuración de \emph{Self Healing} subyacente}

			La idea básica de uso de Arco Iris UI es que, en todo momento, exista una configuración de \emph{Self Healing}
			subyacente. Bien sea que el usuario la haya creado ``desde cero'' o bien, que el usuario haya abierto una
			configuración preexistente desde un archivo.

			\begin{figure}[h]
				\centering
					\includegraphics[scale=0.5]{images/arcoIrisUI_newORopen.png}
				\caption{Diálogo de creación o apertura de archivo}
			\end{figure}

			Ante cualquier acción del usuario de Arco Iris UI dónde se guarden cambios hechos en la configuración activa, la
			aplicación \textbf{guardará automáticamente dichos cambios en el archivo subyacente}. Esto es particularmente útil
			en el caso en que el usuario se encuentre editando el archivo de configuración que Arco Iris está utilizando en
			\emph{runtime}. En ese caso, cualquier cambio automáticamente guardado por Arco Iris UI será detectado al instante
			por Arco Iris, el cuál, tal como se explica en la sección \ref{sec:actualizacionDinamicaConfig}, recargará la
			configuración, dinamizando considerablemente el comportamiento original presente en \emph{Rainbow}.

			\begin{figure}[h]
				\centering
					\includegraphics[scale=0.60]{images/arcoIrisUI_conceptualFlow.png}
				\caption{Flujo conceptual entre Arco Iris UI y Arco Iris}
			\end{figure}
			
		\subsubsection{Auto refresco de tablas}

			Como veremos más adelante en detalle, en Arco Iris UI se visualizan los componentes (i.e. escenarios, entornos,
			\emph{artifacts}, etc.) existentes en el sistema con una tabla que sumariza sus propiedades más relevantes. En general,
			estas tablas se refrescarán automáticamente de acuerdo a los cambios hechos en los objetos subyacentes que componen
			la configuración de \emph{Self Healing}.

		\subsubsection{\emph{Constraints}}
		\label{sec:arcoIrisUI_constraints}

			Tanto en el contexto de creación/edición de un entorno (al imponer restricciones sobre su ocurrencia) como al crear o
			editar el \emph{response measure} de un escenario, las llamadas ``restricciones'' (o \emph{constraints}) son una
			parte fundamental de la configuración requerida para que Arco Iris provea su funcionalidad adecuadamente.
			
			El componente visual asociado a una restricción fue diseñado para ser fácilmente extendido pero, sólo a fines del
			presente trabajo y con el objetivo de acotar la funcionalidad a los límites impuestos en los objetivos del mismo,
			sólo hemos implementado un sólo tipo de restricción: la restricción numérica relacional binaria (ver apéndice
			\ref{sec:numericBinaryRelationalConstraintCode} para más detalle).
			
			\begin{figure}[h]
				\centering
					\includegraphics[scale=0.5]{images/arcoIrisUI_numericBinaryRelationalConstraint.png}
				\caption{Diálogo de creación o edición de una restricción numérica binaria relacional}
				\label{fig:numericBinaryRelationalConstraint}
			\end{figure}

	\subsection{Administración de \emph{Artifacts}}
		Uno de los componentes relevantes a un escenario de auto reparación es el llamado \emph{Artifact}, el cual representa
		al componente de arquitectura que está involucrado en el escenario en cuestión.
		
		Arco Iris UI provee la funcionalidad de alta, baja y modificación (ABM) básica para administrar \emph{artifacts}
		junto con una solapa dentro de la pantalla principal de la aplicación para poder visualizar las propiedades más
		importantes de dichos objetos.

		\begin{figure}[ht]
			\centering
				\includegraphics[scale=0.5]{images/arcoIrisUI_artifact.png}
			\caption[Diálogo de creación o edición de un \emph{artifact}]{Diálogo de creación o edición de un \emph{artifact},
			con su solapa ABM en segundo plano}
		\end{figure}

	\subsection{Administración de Entornos}
		El ``Entorno'' es uno de los componentes más relevantes dentro de un escenario de auto reparación: representa la
		situación concreta (en tiempo de ejecución) dónde el escenario en cuestión va a aplicar.
		
		Al igual que para los \emph{artifacts}, Arco Iris UI provee la funcionalidad de ABM para administrar escenarios
		junto con una solapa para visualizar sus propiedades más relevantes.

		\begin{figure}[ht]
			\centering
				\includegraphics[scale=0.5]{images/arcoIrisUI_environment.png}
			\caption[Diálogo de creación o edición de un entorno]{Diálogo de creación o edición de un entorno, con su solapa ABM
			en segundo plano}
		\end{figure}

		El cuadro de diálogo que muestra las propiedades de un entorno está diseñado para recoger dinámicamente todos los
		\emph{concerns} existentes en el sistema e inicialmente asignarle a cada uno un peso equidistribuído $P$
		determinado de la siguiente forma:
		\begin{equation}
			P = \frac{1}{K}
		\end{equation}
		dónde $K$ es la cantidad de \emph{concerns} existentes en el sistema.
		
		Se observa también la funcionalidad de ABM para las condiciones que se deben cumplir para que el entorno se cumpla en
		\emph{runtime}. Aquí se reutiliza un componente genérico para restricciones, también utilizado en el diálogo de
		creación de un escenario (Ver figura \ref{fig:numericBinaryRelationalConstraint})

	\subsection{Administración de Escenarios}

		Finalmente, llegamos al concepto central del presente trabajo: el escenario de auto reparación. El mismo contiene los
		elementos ya vistos anteriormente junto con otros atributos que repasaremos a continuación. Por supuesto que existe,
		al igual que para los otros conceptos anteriormente vistos, una solapa dedicada para maneja las altas, bajas y
		modificaciones de escenarios.

		\begin{figure}[ht]
			\centering
				\includegraphics[scale=0.5]{images/arcoIrisUI_selfHealingScenario.png}
			\caption[Diálogo de creación o edición de un escenario]{Diálogo de creación o edición de un escenario, con su solapa
			ABM en segundo plano}
		\end{figure}
		
		En la figura anterior observamos que:
		\begin{itemize}
			\item Existe la posibilidad de marcar un escenario como habilitado o deshabilitado. Recordemos que Arco Iris
			únicamente considera escenarios habilitados.
			\item El combo box de \emph{Concerns} se llena con los \emph{concerns} existentes en el sistema al momento de cargarse el
			cuadro de diálogo.
			\item Se permite especificar que el estímulo correspondiente al escenario es ``cualquiera''.
			\item Se permite elegir \emph{artifacts}, considerando los existentes en el sistema o creando ad-hoc uno nuevo.
			\item En el componente ``Response Measure'' se reutiliza el componente mencionado anteriormente en la sección
			\ref{sec:arcoIrisUI_constraints} para crear y editar constraints.
		\end{itemize}

		\subsubsection{Selección de Estrategias de Reparación}
		\label{sec:strategySelectionUI}

			Una funcionalidad interesante de Arco Iris UI es su capacidad para, en el contexto de la creación o edición de un
			escenario, poder elegir una estrategia de reparación directamente desde el archivo \emph{stitch} en el cual se
			encuentra definida la misma. Primeramente, se elige el archivo que contiene las estrategias, para luego seleccionar
			la estrategia deseada, visualizando el código (en el lenguaje de scripting \emph{stitch}) de la misma.

			Es de notar que para el caso de las estrategias de reparación, y a diferencia del resto de los otros conceptos
			explicados hasta este momento, no es posible crear una estrategia ad-hoc, sino que se deben usar únicamente las ya
			existentes.

			\begin{figure}[ht]
				\centering
					\includegraphics[scale=0.5]{images/arcoIrisUI_select_repair_strategy_1.png}
				\caption{Diálogo de selección del archivo que contiene las estrategias}
			\end{figure}
		
			\begin{figure}[ht]
				\centering
					\includegraphics[scale=0.4]{images/arcoIrisUI_select_repair_strategy_2.png}
				\caption{Diálogo de selección de la estrategia de reparación}
			\end{figure}
			
			Al momento de especificar estrategias de reparación, es importante mencionar que la aplicación también permite
			especificar la siguiente semántica:

			``Considerar \textbf{todas} las estrategias de reparación disponibles en Arco Iris al momento de la ejecución''
			
			Lo anterior significa ni más ni menos que el usuario que configura Arco Iris vía Arco Iris UI, no impone un
			conjunto específico de estrategias de reparación a ser utilizadas sino que por lo contrario, permite que cualquier
			estrategia disponible sea considerada por Arco Iris para la reparación del escenario subyacente.

			\begin{figure}[ht]
				\centering
					\includegraphics[width=1.00\textwidth]{images/arcoIrisUI_select_repair_strategy_all.png}
				\caption{Todas las estrategias de reparación disponibles seleccionadas}
			\end{figure}

	\subsection{Puntos de extensión}
	
		A continuación, enunciaremos algunos de los posibles puntos de extensión para únicamente para la herramienta
		Arco Iris UI (en la sección \ref{sec:trabajoFuturo} se cubrirán los puntos de extensión para Arco Iris):
		\begin{itemize}
			\item \textbf{Obtener artefactos y estímulos desde el archivo .acme}: Es deseable el evitar mantener
			en Arco Iris UI un ABM (\textbf{A}lta-\textbf{B}aja-\textbf{M}odificación) de artefactos, así también como que el
			usuario deba especificar estímulos de escenarios de manera no validada por la aplicación, cuando dicha información
			puede ser obtenida mediante un \emph{parsing} del archivo ACME que contiene el modelo de la arquitectura.
			Recordemos que el artefacto de un escenario de atributos de calidad no es ni más ni menos que un componente, un
			conector o un sistema; y un estímulo se encuentra normalmente asociado a una \textbf{operación} provista por el
			artefacto. Esta funcionalidad no fue realizada en el contexto del presente trabajo ya que el \emph{parsing} y
			post procesamiento del archivo .ACME es una tarea no trivial (aunque posible, utilizando clases Java pertenecientes
			a Rainbow).
			\item \textbf{Editor de Tácticas y Estrategias}: Una funcionalidad que de seguro amenizaría la experiencia del
			usuario es sin duda un editor de tácticas y estrategias integrado a Arco Iris UI, con posibilidades de creación,
			edición y borrado. Asociado a ésto está la idea de que esta información sea guardada en el mismo archivo de
			configuración que el resto de la configuración producida por Arco Iris UI. Esta idea será desarrollada con un
			poco más de detalle en la sección \ref{sec:ampliacionConfiguracionExistente}.
		\end{itemize}