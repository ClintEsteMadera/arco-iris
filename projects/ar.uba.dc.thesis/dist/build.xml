<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="dist" basedir="." name="Create distributable runnable jar for Arco Iris with Jar-in-Jar Loader">
    <!--ANT 1.7 is required -->
    
    <property environment="env"/>
    <property name="dist.dir" value="${env.HOME}/ArcoIris"/>
    <property name="project.codebase.dir" value="${basedir}/.."/>
    
    <target name="dist">
        <mkdir dir="${dist.dir}"/>
        <jar destfile="${dist.dir}/arco-iris.jar">
            <!--This is the ideal configuration...it is not working :-( -->
            <!--manifest>
                <attribute name="Main-Class" value="org.sa.rainbow.core.Oracle"/>
                <attribute name="Class-Path" value="./ commons-lang-2.4.jar commons-collections-3.2.1.jar xpp3_min-1.1.4c.jar xstream-1.3.1.jar commons-io-1.2.jar commons-logging-1.1.1.jar log4j-1.2.14.jar velocity-1.6.4-dep.jar org.sa.rainbow.common.jar org.sa.rainbow.communication.jar org.sa.rainbow.core.jar org.sa.rainbow.lang.jar org.acmestudio.standalone-20081209.jar antlr-2.7.6.jar jyaml-lib-1.0-beta-3.jar junit.jar org.hamcrest.core_1.1.0.v20090501071000.jar"/>
            </manifest-->
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
                <attribute name="Rsrc-Main-Class" value="org.sa.rainbow.core.Oracle"/>
                <attribute name="Class-Path" value="."/>
                <attribute name="Rsrc-Class-Path" value="./ commons-lang-2.4.jar commons-collections-3.2.1.jar xpp3_min-1.1.4c.jar xstream-1.3.1.jar commons-io-1.2.jar commons-logging-1.1.1.jar log4j-1.2.14.jar velocity-1.6.4-dep.jar org.sa.rainbow.common.jar org.sa.rainbow.communication.jar org.sa.rainbow.core.jar org.sa.rainbow.lang.jar org.acmestudio.standalone-20081209.jar antlr-2.7.6.jar jyaml-lib-1.0-beta-3.jar junit.jar org.hamcrest.core_1.1.0.v20090501071000.jar"/>
            </manifest>
            <zipfileset src="jar-in-jar-loader.zip"/>
            <fileset dir="${project.codebase.dir}/target"/>
            <zipfileset dir="${project.codebase.dir}/lib" includes="*.jar"/>
        	
        	<!-- To-Do: We need to remove this!! -->
            <fileset dir="${project.codebase.dir}/configs/znewsWithScenarios4"/>
        	
        	<!-- Uncomment if you want to include test libraries -->
            <!--zipfileset dir="${ECLIPSE_HOME}/plugins/org.junit_4.8.1.v4_8_1_v20100427-1100" includes="junit.jar"/>
            <zipfileset dir="${ECLIPSE_HOME}/plugins" includes="org.hamcrest.core_1.1.0.v20090501071000.jar"/-->
        </jar>

    	<!-- Copy test configurations into ${dist.dir} -->
        <copy todir="${dist.dir}/configs">
            <fileset dir="${project.codebase.dir}/configs"/>
        </copy>
    </target>
</project>
